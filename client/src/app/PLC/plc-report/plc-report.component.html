<div class="sticky-div">
  <tabset class="member-tabset">
    <tab heading="Upload Files">
      <app-file-manager [fileVersion]="fileVersion"></app-file-manager>
    </tab>
    <tab heading="Prescriptions">
      <div>
        <label for="noYear">Number of Projections</label>&nbsp;
        <mat-form-field>
          <input
            matInput
            [(ngModel)]="noYear"
            (ngModelChange)="changeColumns()"
          />
        </mat-form-field>
        &nbsp;&nbsp;
        <label for="startYear">Starting Year</label> &nbsp;
        <mat-form-field>
          <input
            matInput
            maxlength="4"
            [(ngModel)]="startYear"
            (ngModelChange)="changeColumns()"
          />
        </mat-form-field>
        &nbsp;&nbsp;
        <label for="decrease">Projected volume with a decrease of</label>&nbsp;
        <mat-form-field>
          <input
            matInput
            [(ngModel)]="decrease"
            ng-pattern="/^[0-9]+(\.[0-9]{1,2})?$/"
            step="0.00"
            (ngModelChange)="changeColumns()"
          />
        </mat-form-field>
      </div>
      <table class="table table-condensed">
        <thead>
          <tr>
            <th *ngFor="let item of AvgYears">{{ item }}</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>April</td>
            <td
              *ngFor="
                let item of AvgYears | slice: 0:AvgYears.length - 1;
                index as idx
              "
              [ngStyle]="{
                'background-color': idx < 4 ? 'rgb(254,242,203)' : 'white'
              }"
            >
              <input
                matInput
                [disabled]="idx > 3"
                [(ngModel)]="MonthPresc[0][idx]"
                value="0"
              />
            </td>
          </tr>
          <tr>
            <td>May</td>
            <td
              *ngFor="
                let item of AvgYears | slice: 0:AvgYears.length - 1;
                index as idx
              "
              [ngStyle]="{
                'background-color': idx < 4 ? 'rgb(254,242,203)' : 'white'
              }"
            >
              <input
                matInput
                [disabled]="idx > 3"
                [(ngModel)]="MonthPresc[1][idx]"
                value="0"
              />
            </td>
          </tr>
          <tr>
            <td>June</td>
            <td
              *ngFor="
                let item of AvgYears | slice: 0:AvgYears.length - 1;
                index as idx
              "
              [ngStyle]="{
                'background-color': idx < 4 ? 'rgb(254,242,203)' : 'white'
              }"
            >
              <input
                matInput
                [disabled]="idx > 3"
                [(ngModel)]="MonthPresc[2][idx]"
                value="0"
              />
            </td>
          </tr>
          <tr>
            <td>July</td>
            <td
              *ngFor="
                let item of AvgYears | slice: 0:AvgYears.length - 1;
                index as idx
              "
              [ngStyle]="{
                'background-color': idx < 4 ? 'rgb(254,242,203)' : 'white'
              }"
            >
              <input
                matInput
                [disabled]="idx > 3"
                [(ngModel)]="MonthPresc[3][idx]"
                value="0"
              />
            </td>
          </tr>
          <tr>
            <td>August</td>
            <td
              *ngFor="
                let item of AvgYears | slice: 0:AvgYears.length - 1;
                index as idx
              "
              [ngStyle]="{
                'background-color': idx < 4 ? 'rgb(254,242,203)' : 'white'
              }"
            >
              <input
                matInput
                [disabled]="idx > 3"
                [(ngModel)]="MonthPresc[4][idx]"
                value="0"
              />
            </td>
          </tr>
          <tr>
            <td>September</td>
            <td
              *ngFor="
                let item of AvgYears | slice: 0:AvgYears.length - 1;
                index as idx
              "
              [ngStyle]="{
                'background-color': idx < 4 ? 'rgb(254,242,203)' : 'white'
              }"
            >
              <input
                matInput
                [disabled]="idx > 3"
                [(ngModel)]="MonthPresc[5][idx]"
                value="0"
              />
            </td>
          </tr>
          <tr>
            <td>October</td>
            <td
              *ngFor="
                let item of AvgYears | slice: 0:AvgYears.length - 1;
                index as idx
              "
              [ngStyle]="{
                'background-color': idx < 4 ? 'rgb(254,242,203)' : 'white'
              }"
            >
              <input
                matInput
                [disabled]="idx > 3"
                [(ngModel)]="MonthPresc[6][idx]"
                value="0"
              />
            </td>
          </tr>
          <tr>
            <td>November</td>
            <td
              *ngFor="
                let item of AvgYears | slice: 0:AvgYears.length - 1;
                index as idx
              "
              [ngStyle]="{
                'background-color': idx < 4 ? 'rgb(254,242,203)' : 'white'
              }"
            >
              <input
                matInput
                [disabled]="idx > 3"
                [(ngModel)]="MonthPresc[7][idx]"
                value="0"
              />
            </td>
          </tr>
          <tr>
            <td>December</td>
            <td
              *ngFor="
                let item of AvgYears | slice: 0:AvgYears.length - 1;
                index as idx
              "
              [ngStyle]="{
                'background-color': idx < 4 ? 'rgb(254,242,203)' : 'white'
              }"
            >
              <input
                matInput
                [disabled]="idx > 3"
                [(ngModel)]="MonthPresc[8][idx]"
                value="0"
              />
            </td>
          </tr>
          <tr>
            <td>January</td>
            <td
              *ngFor="
                let item of AvgYears | slice: 0:AvgYears.length - 1;
                index as idx
              "
              [ngStyle]="{
                'background-color': idx < 4 ? 'rgb(254,242,203)' : 'white'
              }"
            >
              <input
                matInput
                [disabled]="idx > 3"
                [(ngModel)]="MonthPresc[9][idx]"
                value="0"
              />
            </td>
          </tr>
          <tr>
            <td>February</td>
            <td
              *ngFor="
                let item of AvgYears | slice: 0:AvgYears.length - 1;
                index as idx
              "
              [ngStyle]="{
                'background-color': idx < 4 ? 'rgb(254,242,203)' : 'white'
              }"
            >
              <input
                matInput
                [disabled]="idx > 3"
                [(ngModel)]="MonthPresc[10][idx]"
                value="0"
              />
            </td>
          </tr>
          <tr>
            <td>March</td>
            <td
              *ngFor="
                let item of AvgYears | slice: 0:AvgYears.length - 1;
                index as idx
              "
              [ngStyle]="{
                'background-color': idx < 4 ? 'rgb(254,242,203)' : 'white'
              }"
            >
              <input
                matInput
                [disabled]="idx > 3"
                [(ngModel)]="MonthPresc[11][idx]"
                value="0"
              />
            </td>
          </tr>
          <tr>
            <td *ngFor="let item of AvgYears; index as idx">
              <strong>{{
                idx === 0 ? "Total Items" : getTotalItems(idx - 1)
              }}</strong>
            </td>
          </tr>
        </tbody>
      </table>
      <hr />
      <table class="table table-condensed">
        <thead>
          <tr>
            <th *ngFor="let item of Years | slice: 0:3; let i = index">
              {{ item }}
            </th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Total MURs (Max 400)</td>
            <td
              *ngFor="let item of Years | slice: 0:2; index as idx"
              [ngStyle]="{
                'background-color': idx < 2 ? 'rgb(254,242,203)' : 'white'
              }"
            >
              <input
                matInput
                *ngIf="idx < 2"
                [(ngModel)]="mur[idx]"
                value="0"
              />
            </td>
          </tr>
        </tbody>
      </table>
      <hr />
    </tab>
    <tab heading="Sales">
      <div>
        <label for="noYear">Number of Year Projections</label>&nbsp;
        <mat-form-field>
          <input
            matInput
            [(ngModel)]="noYear"
            (ngModelChange)="changeColumns()"
          />
        </mat-form-field>
        &nbsp;&nbsp;
        <label for="startYear">Starting Year</label> &nbsp;
        <mat-form-field>
          <input
            matInput
            [(ngModel)]="startYear"
            (ngModelChange)="changeColumns()"
          />
        </mat-form-field>
      </div>
      <table class="table table-condensed">
        <thead>
          <tr>
            <th *ngFor="let item of Years">{{ item }}</th>
            <th *ngFor="let item of TOYears">{{ item }}</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td colspan="3">
              <strong>Sales: 11 months figures </strong>
            </td>
            <td *ngFor="let item of Years | slice: 3; index as idx"></td>
            <td colspan="3">
              <strong>As % of Total Sales / Turnover </strong>
            </td>
          </tr>
          <tr>
            <td>Zero Rated OTC Sales</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
              [ngStyle]="{
                'background-color': idx < 2 ? 'rgb(254,242,203)' : 'white'
              }"
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="zeroOTCSale[idx]"
                (ngModelChange)="cpZeroOTCSale(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentZeroOTCSale(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td>VAT Exclusive OTC Sales</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
              [ngStyle]="{
                'background-color': idx < 2 ? 'rgb(254,242,203)' : 'white'
              }"
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="vatOTCSale[idx]"
                (ngModelChange)="cpVatOTCSale(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentVatOTCSale(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td *ngFor="let item of Years; index as idx">
              <strong>{{
                idx === 0
                  ? "Total OTC Sales"
                  : (getTotalOTC(idx - 1) | currency: "GBP")
              }}</strong>
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <strong>{{ percentTotalOTC(idx2) }}%</strong>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color':
                  idx != 0 && idx < 3 ? 'rgb(254,242,203)' : 'white'
              }"
            >
              {{
                idx === 0
                  ? "NHS Sales Reimbursement (net)"
                  : getNHSSalesReimburse(idx)
              }}
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentNHSSalesReimburse(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td *ngFor="let item of Years; index as idx">
              {{ idx === 0 ? "SAF" : getSAF(idx - 1) }}
            </td>
            <td *ngFor="let item of TOYears"></td>
          </tr>
          <tr>
            <td *ngFor="let item of Years; index as idx">
              {{
                idx === 0
                  ? "Establishment Payment"
                  : idx < 3
                  ? getEstablishedPay(idx - 1)
                  : ""
              }}
            </td>
            <td *ngFor="let item of TOYears"></td>
          </tr>
          <tr>
            <td>Other</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
              [ngStyle]="{
                'background-color': idx < 2 ? 'rgb(254,242,203)' : 'white'
              }"
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="nhsother[idx]"
                (ngModelChange)="cpNhsOther(idx)"
                value="0"
              />
            </td>
            <td *ngFor="let item of TOYears"></td>
          </tr>
          <tr>
            <td *ngFor="let item of Years; index as idx">
              <strong>{{
                idx === 0
                  ? "Subtotal (Ess. Services)"
                  : (getSubtotalNHS(idx - 1) | currency: "GBP")
              }}</strong>
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <strong>{{ percentSubtotalNHS(idx2) }}%</strong>
            </td>
          </tr>
          <tr
            [ngStyle]="{
              'background-color': 'rgb(217,226,243)'
            }"
          >
            <td *ngFor="let item of Years; index as idx">
              {{
                idx === 0
                  ? "As % of Gross Profit"
                  : (getSubtotalNHS(idx - 1) / getGross(idx) | percent)
              }}
            </td>
            <td *ngFor="let item of TOYears"></td>
          </tr>
          <tr>
            <td>NMS</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
              [ngStyle]="{
                'background-color': idx < 2 ? 'rgb(254,242,203)' : 'white'
              }"
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="nms[idx]"
                (ngModelChange)="cpNms(idx)"
                value="0"
              />
            </td>
            <td *ngFor="let item of TOYears"></td>
          </tr>
          <tr>
            <td *ngFor="let item of Years; index as idx">
              {{ idx === 0 ? "MUR" : idx < 3 ? getMUR(idx - 1) : "" }}
            </td>
            <td *ngFor="let item of TOYears"></td>
          </tr>
          <tr>
            <td>Transition Payment</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input matInput [(ngModel)]="transitionpay[idx]" value="0" />
            </td>
            <td *ngFor="let item of TOYears"></td>
          </tr>
          <tr>
            <td>Other</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
              [ngStyle]="{
                'background-color': idx < 2 ? 'rgb(254,242,203)' : 'white'
              }"
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="advother[idx]"
                (ngModelChange)="cpAdvOther(idx)"
                value="0"
              />
            </td>
            <td *ngFor="let item of TOYears"></td>
          </tr>
          <tr>
            <td *ngFor="let item of Years; index as idx">
              <strong>{{
                idx === 0
                  ? "Subtotal (Adv. Services)"
                  : (getSubtotalAdv(idx) | currency: "GBP")
              }}</strong>
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <strong>{{ percentSubtotalAdv(idx2) }}%</strong>
            </td>
          </tr>
          <tr
            [ngStyle]="{
              'background-color': 'rgb(217,226,243)'
            }"
          >
            <td *ngFor="let item of Years; index as idx">
              {{
                idx === 0
                  ? "As % of gross profit"
                  : (getSubtotalAdv(idx) / getGross(idx) | percent)
              }}
            </td>
            <td *ngFor="let item of TOYears"></td>
          </tr>
          <tr>
            <td>NHS Enhanced services</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
              [ngStyle]="{
                'background-color': idx < 2 ? 'rgb(254,242,203)' : 'white'
              }"
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="nhsenhancedserv[idx]"
                (ngModelChange)="cpNHSenhancedServ(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentNhsEnhancedServ(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td>NHS Sundries</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
              [ngStyle]="{
                'background-color': idx < 2 ? 'rgb(254,242,203)' : 'white'
              }"
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="nhsundries[idx]"
                (ngModelChange)="cpNHSundries(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentNhSundries(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td>Quality Payments</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
              [ngStyle]="{
                'background-color': idx < 2 ? 'rgb(254,242,203)' : 'white'
              }"
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="qualitypay[idx]"
                (ngModelChange)="cpQualityPay(idx)"
                value="0"
              />
            </td>
            <td *ngFor="let item of TOYears"></td>
          </tr>
          <tr>
            <td>Pharmacy Access Scheme</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
              [ngStyle]="{
                'background-color': idx < 2 ? 'rgb(254,242,203)' : 'white'
              }"
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="pharmacyaccscheme[idx]"
                (ngModelChange)="cpPharmacy(idx)"
                value="0"
              />
            </td>
            <td *ngFor="let item of TOYears"></td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color':
                  idx !== 0 && idx < 3 ? 'rgb(254,242,203)' : 'white'
              }"
            >
              {{ idx == 0 ? "Buying Profit" : getBuyingProfit(idx) }}
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentBuyingProfit(idx2) }}%</p>
            </td>
          </tr>
          <tr
            [ngStyle]="{
              'background-color': 'rgb(217,226,243)'
            }"
          >
            <td *ngFor="let item of Years; index as idx">
              {{
                idx === 0
                  ? "As % of gross profit"
                  : (getBuyingProfit(idx) / getGross(idx) | percent)
              }}
            </td>
            <td *ngFor="let item of TOYears"></td>
          </tr>
          <tr>
            <td *ngFor="let item of Years; index as idx">
              <strong>{{
                idx === 0
                  ? "Total NHS Sales"
                  : (getNHSSales(idx) | currency: "GBP")
              }}</strong>
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <strong>{{ percentNHSSales(idx2) }}%</strong>
            </td>
          </tr>
          <tr>
            <td *ngFor="let item of Years; index as idx">
              <strong>{{
                idx === 0
                  ? "Grand total sales / Turnover (£)"
                  : (getGrandTotalNHS(idx) | currency: "GBP")
              }}</strong>
            </td>
            <td *ngFor="let item of TOYears"></td>
          </tr>
        </tbody>
      </table>
    </tab>
    <tab heading="Gross Profit">
      <div>
        <label for="noYear">Number of Year Projections</label>&nbsp;
        <mat-form-field>
          <input
            matInput
            [(ngModel)]="noYear"
            (ngModelChange)="changeColumns()"
          />
        </mat-form-field>
        &nbsp;&nbsp;
        <label for="startYear">Starting Year</label> &nbsp;
        <mat-form-field>
          <input
            matInput
            [(ngModel)]="startYear"
            (ngModelChange)="changeColumns()"
          />
        </mat-form-field>
      </div>
      <table class="table table-condensed">
        <thead>
          <tr>
            <th *ngFor="let item of Years">{{ item }}</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color':
                  idx !== 0 && idx < 3 ? 'rgb(254,242,203)' : 'white'
              }"
            >
              {{ idx == 0 ? "OTC Sales" : getTotalOTC(idx - 1) * 0.85 }}
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color':
                  idx !== 0 && idx < 3 ? 'rgb(254,242,203)' : 'white'
              }"
            >
              {{ idx == 0 ? "NHS Sales" : getNHSSalesReimburse(idx) * 0.8 }}
            </td>
          </tr>
          <tr>
            <td *ngFor="let item of Years; index as idx">
              <strong>{{
                idx === 0
                  ? "Total cost of sales"
                  : (getTotal(idx) | currency: "GBP")
              }}</strong>
            </td>
          </tr>
          <tr>
            <td *ngFor="let item of Years; index as idx"></td>
          </tr>
          <tr>
            <td *ngFor="let item of Years; index as idx">
              <strong>{{
                idx === 0
                  ? "Gross Profit (£)"
                  : (getGross(idx) | currency: "GBP")
              }}</strong>
            </td>
          </tr>
        </tbody>
      </table>
    </tab>
    <tab heading="Expenses">
      <div>
        <label for="noYear">Number of Year Projections</label>&nbsp;
        <mat-form-field>
          <input
            matInput
            [(ngModel)]="noYear"
            (ngModelChange)="changeColumns()"
          />
        </mat-form-field>
        &nbsp;&nbsp;
        <label for="startYear">Starting Year</label> &nbsp;
        <mat-form-field>
          <input
            matInput
            [(ngModel)]="startYear"
            (ngModelChange)="changeColumns()"
          />
        </mat-form-field>
      </div>
      <table class="table table-condensed">
        <thead>
          <tr>
            <th *ngFor="let item of Years">{{ item }}</th>
            <th *ngFor="let item of TOYears">{{ item }}</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Directors’ Pension and salaries/ Owner's withdrawals</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="directorsalary[idx]"
                (ngModelChange)="cpDirectorSalary(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentDirectorSalary(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              {{
                idx === 0
                  ? "As % of gross profit"
                  : directorsalary[idx - 1] !== undefined
                  ? (directorsalary[idx - 1] / getGross(idx) | percent)
                  : (0 | percent)
              }}
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td>Employee salary and wage costs</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="employeesalary[idx]"
                (ngModelChange)="cpEmployeeSalary(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentEmployeeSalary(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              {{
                idx === 0
                  ? "As % of gross profit"
                  : employeesalary[idx - 1] !== undefined
                  ? (employeesalary[idx - 1] / getGross(idx) | percent)
                  : (0 | percent)
              }}
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td>Locum costs</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="locumcost[idx]"
                (ngModelChange)="cpLocumCost(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentLocumCost(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              {{
                idx === 0
                  ? "As % of gross profit"
                  : locumcost[idx - 1] !== undefined
                  ? (locumcost[idx - 1] / getGross(idx) | percent)
                  : (0 | percent)
              }}
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td>Other personnel costs</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="othercost[idx]"
                (ngModelChange)="cpOtherCost(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentOtherCost(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              {{
                idx === 0
                  ? "As % of gross profit"
                  : othercost[idx - 1] !== undefined
                  ? (othercost[idx - 1] / getGross(idx) | percent)
                  : (0 | percent)
              }}
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td *ngFor="let item of Years; index as idx">
              <strong>{{
                idx === 0
                  ? "Total personnel costs"
                  : (getTotalPersonelCost(idx - 1) | currency: "GBP")
              }}</strong>
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <strong>{{ percentTotalPersonelCost(idx2) }}%</strong>
            </td>
          </tr>
          <tr
            [ngStyle]="{
              'background-color': 'rgb(217,226,243)'
            }"
          >
            <td *ngFor="let item of Years; index as idx">
              <strong>{{
                idx === 0
                  ? "As % of Gross Profit"
                  : (getTotalPersonelCost(idx) / getGross(idx) | percent)
              }}</strong>
            </td>
            <td *ngFor="let item of TOYears"></td>
          </tr>
          <tr>
            <td>Rent</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="rent[idx]"
                (ngModelChange)="cpRent(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentRent(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              {{
                idx === 0
                  ? "As % of gross profit"
                  : rent[idx - 1] !== undefined
                  ? (rent[idx - 1] / getGross(idx) | percent)
                  : (0 | percent)
              }}
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td>Rates</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="rates[idx]"
                (ngModelChange)="cpRates(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentRates(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              {{
                idx === 0
                  ? "As % of gross profit"
                  : rates[idx - 1] !== undefined
                  ? (rates[idx - 1] / getGross(idx) | percent)
                  : (0 | percent)
              }}
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td>Utilities (heat and light)</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="utilities[idx]"
                (ngModelChange)="cpUtilities(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentUtilities(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              {{
                idx === 0
                  ? "As % of gross profit"
                  : utilities[idx - 1] !== undefined
                  ? (utilities[idx - 1] / getGross(idx) | percent)
                  : (0 | percent)
              }}
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td>Telephone costs</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="telephone[idx]"
                (ngModelChange)="cpTelephone(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentTelephone(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              {{
                idx === 0
                  ? "As % of gross profit"
                  : telephone[idx - 1] !== undefined
                  ? (telephone[idx - 1] / getGross(idx) | percent)
                  : (0 | percent)
              }}
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td>Repairs and renewals</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="repair[idx]"
                (ngModelChange)="cpRepair(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentRepair(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              {{
                idx === 0
                  ? "As % of gross profit"
                  : repair[idx - 1] !== undefined
                  ? (repair[idx - 1] / getGross(idx) | percent)
                  : (0 | percent)
              }}
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td>Communication and website</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="communication[idx]"
                (ngModelChange)="cpCommunication(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentCommunication(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              {{
                idx === 0
                  ? "As % of gross profit"
                  : communication[idx - 1] !== undefined
                  ? (communication[idx - 1] / getGross(idx) | percent)
                  : (0 | percent)
              }}
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td>Leasing and rentals</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="leasing[idx]"
                (ngModelChange)="cpLeasing(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentLeasing(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              {{
                idx === 0
                  ? "As % of gross profit"
                  : leasing[idx - 1] !== undefined
                  ? (leasing[idx - 1] / getGross(idx) | percent)
                  : (0 | percent)
              }}
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td>Insurance</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="insurance[idx]"
                (ngModelChange)="cpInsurance(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentInsurance(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              {{
                idx === 0
                  ? "As % of gross profit"
                  : insurance[idx - 1] !== undefined
                  ? (insurance[idx - 1] / getGross(idx) | percent)
                  : (0 | percent)
              }}
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td>Professional Indemnity</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="proindemnity[idx]"
                (ngModelChange)="cpProindemnity(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentProindemnity(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              {{
                idx === 0
                  ? "As % of gross profit"
                  : proindemnity[idx - 1] !== undefined
                  ? (proindemnity[idx - 1] / getGross(idx) | percent)
                  : (0 | percent)
              }}
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td>Computer and IT costs</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="computerit[idx]"
                (ngModelChange)="cpComputerit(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentComputerit(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              {{
                idx === 0
                  ? "As % of gross profit"
                  : computerit[idx - 1] !== undefined
                  ? (computerit[idx - 1] / getGross(idx) | percent)
                  : (0 | percent)
              }}
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td>Recruitment and training</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="recruitment[idx]"
                (ngModelChange)="cpRecruitment(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentRecruitment(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              {{
                idx === 0
                  ? "As % of gross profit"
                  : recruitment[idx - 1] !== undefined
                  ? (recruitment[idx - 1] / getGross(idx) | percent)
                  : (0 | percent)
              }}
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td>Professional registration fees (e.g. GPhC, NPA)</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="registrationfee[idx]"
                (ngModelChange)="cpRegistrationfee(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentRegistrationfee(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              {{
                idx === 0
                  ? "As % of gross profit"
                  : registrationfee[idx - 1] !== undefined
                  ? (registrationfee[idx - 1] / getGross(idx) | percent)
                  : (0 | percent)
              }}
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td>Marketing and advertising</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="marketing[idx]"
                (ngModelChange)="cpMarketing(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentMarketing(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              {{
                idx === 0
                  ? "As % of gross profit"
                  : marketing[idx - 1] !== undefined
                  ? (marketing[idx - 1] / getGross(idx) | percent)
                  : (0 | percent)
              }}
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td>Travel</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="travel[idx]"
                (ngModelChange)="cpTravel(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentTravel(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              {{
                idx === 0
                  ? "As % of gross profit"
                  : travel[idx - 1] !== undefined
                  ? (travel[idx - 1] / getGross(idx) | percent)
                  : (0 | percent)
              }}
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td>Entertainment</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="entertainment[idx]"
                (ngModelChange)="cpEntertainment(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentEntertainment(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              {{
                idx === 0
                  ? "As % of gross profit"
                  : entertainment[idx - 1] !== undefined
                  ? (entertainment[idx - 1] / getGross(idx) | percent)
                  : (0 | percent)
              }}
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td>Transport</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="transport[idx]"
                (ngModelChange)="cpTransport(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentTransport(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              {{
                idx === 0
                  ? "As % of gross profit"
                  : transport[idx - 1] !== undefined
                  ? (transport[idx - 1] / getGross(idx) | percent)
                  : (0 | percent)
              }}
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td>Accountancy and legal</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="accountancy[idx]"
                (ngModelChange)="cpAccountancy(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentAccountancy(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              {{
                idx === 0
                  ? "As % of gross profit"
                  : accountancy[idx - 1] !== undefined
                  ? (accountancy[idx - 1] / getGross(idx) | percent)
                  : (0 | percent)
              }}
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td>Banking costs</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="banking[idx]"
                (ngModelChange)="cpBanking(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentBanking(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              {{
                idx === 0
                  ? "As % of gross profit"
                  : banking[idx - 1] !== undefined
                  ? (banking[idx - 1] / getGross(idx) | percent)
                  : (0 | percent)
              }}
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td>Interest costs</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="interest[idx]"
                (ngModelChange)="cpInterest(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentInterest(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              {{
                idx === 0
                  ? "As % of gross profit"
                  : interest[idx - 1] !== undefined
                  ? (interest[idx - 1] / getGross(idx) | percent)
                  : (0 | percent)
              }}
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td>Other</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="otherexpense[idx]"
                (ngModelChange)="cpOtherexpense(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentOtherexpense(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              {{
                idx === 0
                  ? "As % of gross profit"
                  : otherexpense[idx - 1] !== undefined
                  ? (otherexpense[idx - 1] / getGross(idx) | percent)
                  : (0 | percent)
              }}
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td>Amortalisation of intangible fixed assets (Goodwill)</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="amortalisation[idx]"
                (ngModelChange)="cpAmortalisation(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentAmortalisation(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              {{
                idx === 0
                  ? "As % of gross profit"
                  : amortalisation[idx - 1] !== undefined
                  ? (amortalisation[idx - 1] / getGross(idx) | percent)
                  : (0 | percent)
              }}
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td>Depreciation of tangible assts (fixtures and fittings)</td>
            <td
              *ngFor="
                let item of Years | slice: 0:Years.length - 1;
                index as idx
              "
            >
              <input
                matInput
                [disabled]="idx > 1"
                [(ngModel)]="depreciation[idx]"
                (ngModelChange)="cpDepreciation(idx)"
                value="0"
              />
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <p>{{ percentDepreciation(idx2) }}%</p>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              {{
                idx === 0
                  ? "As % of gross profit"
                  : depreciation[idx - 1] !== undefined
                  ? (depreciation[idx - 1] / getGross(idx) | percent)
                  : (0 | percent)
              }}
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td *ngFor="let item of Years; index as idx">
              <strong>{{
                idx === 0
                  ? "Total operating costs"
                  : (getTotalOperatingCost(idx - 1) | currency: "GBP")
              }}</strong>
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <strong>{{ percentTotalOperatingCost(idx2) }}%</strong>
            </td>
          </tr>
          <tr>
            <td
              *ngFor="let item of Years; index as idx"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            >
              <strong>{{
                idx === 0
                  ? "As % of gross profit"
                  : (getTotalOperatingCost(idx - 1) / getGross(idx) | percent)
              }}</strong>
            </td>
            <td
              *ngFor="let item of TOYears"
              [ngStyle]="{
                'background-color': 'rgb(217,226,243)'
              }"
            ></td>
          </tr>
          <tr>
            <td *ngFor="let item of Years; index as idx">
              <strong>{{
                idx === 0
                  ? "Total Expense"
                  : (getTotalExpense(idx - 1) | currency: "GBP")
              }}</strong>
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <strong>{{ percentTotalExpense(idx2) }}%</strong>
            </td>
          </tr>
          <tr
            [ngStyle]="{
              'background-color': 'rgb(217,226,243)'
            }"
          >
            <td *ngFor="let item of Years; index as idx">
              <strong>{{
                idx == 0
                  ? "As % of Gross Profit"
                  : (getTotalExpense(idx - 1) / getGross(idx) | percent)
              }}</strong>
            </td>
            <td *ngFor="let item of TOYears"></td>
          </tr>
          <tr
            [ngStyle]="{
              'background-color': 'rgb(244,176,131)'
            }"
          >
            <td *ngFor="let item of Years; index as idx">
              <strong>{{
                idx === 0
                  ? "Profit/Loss"
                  : (getProfitLoss(idx) | currency: "GBP")
              }}</strong>
            </td>
            <td
              [ngStyle]="{
                'background-color': 'rgb(180,198,231)'
              }"
              *ngFor="let item of TOYears; index as idx2"
            >
              <strong>{{ percentProfitLoss(idx2) }}%</strong>
            </td>
          </tr>
          <tr
            [ngStyle]="{
              'background-color': 'rgb(217,226,243)'
            }"
          >
            <td *ngFor="let item of Years; index as idx">
              <strong>{{
                idx == 0
                  ? "As % of Gross Profit"
                  : (getProfitLoss(idx) / getGross(idx) | percent)
              }}</strong>
            </td>
            <td *ngFor="let item of TOYears"></td>
          </tr>
        </tbody>
      </table>
    </tab>
    <tab heading="Inflation">
      <div>
        <label for="noYear">Number of Year Projections</label>&nbsp;
        <mat-form-field>
          <input
            matInput
            [(ngModel)]="noYear"
            (ngModelChange)="changeColumns()"
          />
        </mat-form-field>
        &nbsp;&nbsp;
        <label for="startYear">Starting Year</label> &nbsp;
        <mat-form-field>
          <input
            matInput
            [(ngModel)]="startYear"
            (ngModelChange)="changeColumns()"
          />
        </mat-form-field>
      </div>
      <strong
        >Inflation assuming expenses remain constant (value given for
        {{ InfYears[1] }}) except for inflation increase</strong
      >
      <table class="table table-condensed">
        <thead>
          <tr>
            <th colspan="1">Total Expenses after Inflation at:</th>
            <th *ngFor="let item of InfYears">{{ item }}</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td></td>
            <td *ngFor="let item of InfYears; index as idx">
              {{
                idx == 0
                  ? (inflation[0] | percent)
                  : (calcInflation(0, idx) | number: "1.2-2")
              }}
            </td>
          </tr>
          <tr>
            <td></td>
            <td *ngFor="let item of InfYears; index as idx">
              {{
                idx == 0
                  ? (inflation[1] | percent)
                  : (calcInflation(1, idx) | number: "1.2-2")
              }}
            </td>
          </tr>
          <tr>
            <td></td>
            <td *ngFor="let item of InfYears; index as idx">
              {{
                idx == 0
                  ? (inflation[2] | percent)
                  : (calcInflation(2, idx) | number: "1.2-2")
              }}
            </td>
          </tr>
          <tr
            [ngStyle]="{
              'background-color': 'rgb(244,176,131)'
            }"
          >
            <td>Profit/Loss after inflation</td>
            <td *ngFor="let item of InfYears; index as idx">
              <strong>{{
                idx == 0
                  ? (inflation[0] | percent)
                  : (calcInflation2(0, idx) | number)
              }}</strong>
            </td>
          </tr>
          <tr
            [ngStyle]="{
              'background-color': 'rgb(244,176,131)'
            }"
          >
            <td></td>
            <td *ngFor="let item of InfYears; index as idx">
              <strong>{{
                idx == 0
                  ? (inflation[1] | percent)
                  : (calcInflation2(1, idx) | number)
              }}</strong>
            </td>
          </tr>
          <tr
            [ngStyle]="{
              'background-color': 'rgb(244,176,131)'
            }"
          >
            <td></td>
            <td *ngFor="let item of InfYears; index as idx">
              <strong>{{
                idx == 0
                  ? (inflation[2] | percent)
                  : (calcInflation2(2, idx) | number)
              }}</strong>
            </td>
          </tr>
        </tbody>
      </table>
      <br />
      <strong
        >Calculate the effect of inflation assuming expenses remain constant
        (value given for {{ InfYears[1] }}) except for inflation
        increase</strong
      >
      <table class="table table-condensed" style="width: 40%">
        <tbody>
          <tr>
            <td>
              <strong>Rate of inflation</strong>
            </td>
            <td [ngStyle]="{ 'background-color': 'rgb(254,242,203)' }">
              <input
                matInput
                [(ngModel)]="rateinflation"
                ng-pattern="/^[0-9]+(\.[0-9]{1,2})?$/"
                step="0.00"
              />
            </td>
            <td [ngStyle]="{ 'background-color': 'rgb(254,242,203)' }">
              <span matSuffix>%</span>
            </td>
            <td></td>
          </tr>
          <tr>
            <td><strong>Years</strong></td>
            <td
              [ngStyle]="{ 'background-color': 'rgb(254,242,203)' }"
              colspan="2"
            >
              <input matInput [(ngModel)]="noYear" />
            </td>
          </tr>
          <tr>
            <td><strong>Increase in expenses (£)</strong></td>
            <td colspan="2">{{ increaseExpense() | number: "1.2-2" }}</td>
          </tr>
          <tr>
            <td><strong>Total expenses after inflation (£)</strong></td>
            <td colspan="2">{{ getExpenseAfterInfl() | number: "1.2-2" }}</td>
          </tr>
          <tr [ngStyle]="{ 'background-color': 'rgb(191,191,191)' }">
            <td><strong>Profit/Loss after inflation (£)</strong></td>
            <td colspan="2">{{ getPLAfterInfl() | number: "1.2-2" }}</td>
          </tr>
          <tr>
            <td>
              <strong>Total Expenses after inflation % of Gross Profit</strong>
            </td>
            <td
              [ngStyle]="{ 'background-color': 'rgb(217,226,243)' }"
              colspan="2"
            >
              {{ getPLAfterInflPercent() | percent }}
            </td>
          </tr>
          <tr>
            <td>
              <strong>Total Expenses after inflation % of Turnover</strong>
            </td>
            <td
              [ngStyle]="{ 'background-color': 'rgb(180,198,231)' }"
              colspan="2"
            >
              {{ getExpenseAfterInflPercent() | percent }}
            </td>
          </tr>
        </tbody>
      </table>
      <br />
      <strong
        >Profit from total OTC sales (assumed 23% for illistrative purposes) as
        % of gross profit</strong
      >
      <table class="table table-condensed">
        <thead>
          <tr>
            <th *ngFor="let item of InfYears">
              <strong>{{ item }}</strong>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>Profit from Total OTC Sales</strong></td>
            <td
              *ngFor="
                let item of InfYears | slice: 0:InfYears.length - 1;
                index as idx
              "
            >
              <strong>{{ (getTotalOTC(idx) / 100) * 23 }}</strong>
            </td>
          </tr>
        </tbody>
      </table>
      <button
        class="btn btn-success mr-2"
        (click)="saveExpense(1)"
        type="submit"
      >
        Save Data
      </button>
    </tab>
  </tabset>
</div>
